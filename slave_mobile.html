<html>
	<head>
	<meta name="viewport" content="user-scalable=no, width=device-width" />
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
	<script>
		var audioBuffer = null,
			context = new webkitAudioContext(),
			socket = io.connect('http://192.168.1.167'),
			globalSource = context.createBufferSource();

		function loadAudio(url) {
		  var request = new XMLHttpRequest();
		  request.open('GET', url, true);
		  request.responseType = 'arraybuffer';
		  request.onload = function() {
		    context.decodeAudioData(request.response, function(buffer) {
		    	console.log('decode recieved');
		      globalSource.buffer = buffer;
		      globalSource.connect(context.destination); 
		      $("#info").text('decoded');
		    }, function(err){
		    	console.log(err);
		    });
		  }
		  request.send();
		}

		socket.on('slaveEvent', function (data) {
      if (data.audioEvent == 'play') {
          $("#info")
              .text("playing")
              .css("color", "green");

          globalSource.noteOn(0);

      }
      else if (data.audioEvent == 'stop') {
          $("#info")
              .text("playing")
              .css("color", "green");

          globalSource.noteOn(0);

      }
    });

		loadAudio('http://192.168.1.167/static/audio/oct17_track3.mp3');

	</script>
	</head>
	<body>
		<div id="info">

		</div>
	</body>
</html>